<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0">
    
    <meta name="screen-orientation" content="portrait">
    <meta name="x5-orientation" content="portrait">
    <meta name="t5-orientation" content="portrait">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#1e293b">

    <title>HAN-GL MOA</title>
    
    <link rel="stylesheet" href="css/style.css">
    
    <style>
        /* í—¤ë” ì»¨íŠ¸ë¡¤ ì˜ì—­ (ìƒˆ ê²Œì„ ë²„íŠ¼ + ì„¤ì • ë²„íŠ¼) */
        .header-controls {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        /* ì„¤ì • ì•„ì´ì½˜ ë²„íŠ¼ */
        .btn-icon-setting {
            background: rgba(255,255,255,0.1);
            border: none;
            color: #fff;
            width: 40px;
            height: 40px;
            border-radius: 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s;
        }
        .btn-icon-setting:active { background: rgba(255,255,255,0.2); transform: scale(0.95); }

        /* ì„¤ì • íŒì—… ë‚´ë¶€ ìŠ¤íƒ€ì¼ */
        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            color: #fff;
            font-size: 16px;
        }
        .setting-item:last-child { border-bottom: none; }
        .setting-label { display: flex; align-items: center; gap: 8px; }

        /* í† ê¸€ ìŠ¤ìœ„ì¹˜ CSS */
        .switch { position: relative; display: inline-block; width: 44px; height: 24px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider {
            position: absolute; cursor: pointer;
            top: 0; left: 0; right: 0; bottom: 0;
            background-color: #555; transition: .4s; border-radius: 24px;
        }
        .slider:before {
            position: absolute; content: "";
            height: 18px; width: 18px;
            left: 3px; bottom: 3px;
            background-color: white; transition: .4s; border-radius: 50%;
        }
        input:checked + .slider { background-color: #8b5cf6; }
        input:checked + .slider:before { transform: translateX(20px); }
        input:disabled + .slider { background-color: #333; opacity: 0.5; cursor: not-allowed; }

        .divider { height: 1px; background: rgba(255,255,255,0.1); margin: 15px 0; border: none; }
        
        /* í”„ë¦¬ë¯¸ì—„ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .btn-premium {
            width: 100%;
            padding: 14px;
            border: none;
            border-radius: 12px;
            background: linear-gradient(135deg, #FFD700, #FFA500);
            color: #000;
            font-weight: bold;
            font-size: 16px;
            cursor: pointer;
            margin-top: 10px;
            box-shadow: 0 4px 15px rgba(255, 165, 0, 0.3);
        }
        .btn-premium:active { transform: scale(0.98); }
    </style>

    <script src="js/confetti.js"></script>
    <script src="js/levels.js"></script>
    <script src="js/dictionary.js"></script>
</head>
<body>

    <div id="introScreen" class="intro-screen">
    <div class="intro-bg-container">
        <div class="board-3d">
            <img src="images/intro_board.png" alt="Game Board" class="board-img">
            <div class="hand-pointer">ğŸ‘†</div>
            <svg class="drag-trail" width="100%" height="100%">
                <path d="M120,110 L180,110 L120,180 L180,180" fill="none" stroke="#fff" stroke-width="14" stroke-linecap="round" stroke-dasharray="300" stroke-dashoffset="300"/>
            </svg>
        </div>
        <div class="bg-overlay"></div>
    </div> 

    <div class="intro-content">
        <img src="images/logo_intro.png" alt="HAN-GL MOA" class="intro-logo">
        <button class="btn-start" onclick="startFromIntro()">GAME START</button>
    </div>
</div>

    <div id="countdownOverlay" class="countdown-overlay">
        <div id="countdownCard" class="countdown-card">
            <span id="countdownText" class="countdown-text">3</span>
        </div>
        <div class="countdown-msg">ìƒˆ ê²Œì„ì„ ì‹œì‘í•©ë‹ˆë‹¤</div>
    </div>

    <div id="toast" class="toast hidden">
        <span id="toastWord" class="toast-word"></span>
        <span id="toastDesc" class="toast-desc"></span>
    </div>

    <div class="header-area">
        <img src="images/logo_game.png" alt="MOA" class="header-logo">
        
        <div class="header-controls">
            <button class="btn-new-game" onclick="startWithCountdown()">
                <span>â†» ìƒˆ ê²Œì„</span>
            </button>
            
            <button id="btnSettings" class="btn-icon-setting" onclick="openSettingsModal()">
                <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="3"></circle>
                    <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 5 4.6a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
                </svg>
            </button>
        </div>
    </div>

    <div class="control-bar">
        <button id="btnGridSize" class="setting-btn" onclick="openOptionModal('grid')">
            <svg class="setting-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><line x1="3" y1="9" x2="21" y2="9"></line><line x1="3" y1="15" x2="21" y2="15"></line><line x1="9" y1="3" x2="9" y2="21"></line><line x1="15" y1="3" x2="15" y2="21"></line></svg>
            <span id="txtGridSize">4x4</span>
        </button>

        <button id="btnLevel" class="setting-btn" onclick="openOptionModal('level')">
            <svg class="setting-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="20" x2="12" y2="10"></line><line x1="18" y1="20" x2="18" y2="4"></line><line x1="6" y1="20" x2="6" y2="16"></line></svg>
            <span id="txtLevel">ëœë¤</span>
        </button>

        <div class="mode-switch">
            <button class="mode-btn active" id="btnPractice" onclick="setMode('practice')">ì—°ìŠµ</button>
            <button class="mode-btn" id="btnChallenge" onclick="setMode('challenge')">ì±Œë¦°ì§€</button>
        </div>
    </div>

    <div class="stats-bar">
        <div class="stat-group">
            <span class="stat-label">SCORE</span>
            <div>
                <span class="score-val" id="score">0</span>
                <span class="score-target" id="targetScoreDisplay">/ 100</span>
            </div>
        </div>

        <div class="stat-group" id="statWordGroup" style="display:none;">
            <span class="stat-label">ë‹¨ì–´ (ì°¾ì€ê²ƒ/ì „ì²´)</span>
            <div>
                <span class="score-val" id="foundCount">0</span>
                <span class="score-target" id="totalCount">/ 0</span>
            </div>
        </div>

        <div class="stat-group" style="align-items:flex-end;">
            <span class="stat-label">TIME</span>
            <div class="timer-val" id="timer">00:00</div>
        </div>
    </div>

    <div class="found-area">
        <div class="word-list" id="wordList"></div>
    </div>

    <div class="bottom-container">
        <div class="mission-container">
            <div id="hintTooltip" class="hint-tooltip">ëˆŒëŸ¬ì„œ íŒíŠ¸ ë³´ê¸°!</div>
            <div id="hintBar" class="mission-bar hidden">
                <span class="mission-icon">ğŸ</span>
                <span id="hintText">íŒíŠ¸</span>
                <span id="hintScore" class="mission-score">+50</span>
            </div>
            <button id="btnHint" class="hint-btn hidden" onclick="useHint()">
                ğŸ’¡ íŒíŠ¸ ë³´ê¸°
            </button>
        </div>

        <div class="current-word" id="currentWord">ì‹œì‘</div>
        <div class="grid" id="grid"></div>
    </div>

    <div class="overlay" id="optionModal">
        <div class="modal">
            <div class="modal-title" id="optTitle">ì„¤ì •</div>
            <div class="option-list" id="optList"></div>
            <button class="btn-full btn-gray" onclick="closeOptionModal()">ë‹«ê¸°</button>
        </div>
    </div>

    <div class="overlay" id="settingsModal">
        <div class="modal">
            <div class="modal-title">ì„¤ì •</div>
            
            <div style="margin: 20px 0;">
                <div class="setting-item">
                    <div class="setting-label">ğŸ“³ ì§„ë™ íš¨ê³¼</div>
                    <label class="switch">
                        <input type="checkbox" id="vibrateToggle" checked onchange="toggleVibration(this)">
                        <span class="slider round"></span>
                    </label>
                </div>

                <div class="setting-item">
                    <div class="setting-label">ğŸ”Š íš¨ê³¼ìŒ</div>
                    <label class="switch">
                        <input type="checkbox" id="soundToggle" checked onchange="toggleSound(this)">
                        <span class="slider round"></span>
                    </label>
                </div>
            </div>

            <hr class="divider">

            <button id="btnRemoveAdsInSetting" class="btn-premium" onclick="AdManager.purchaseRemoveAds()">
                ğŸš« ê´‘ê³  ì œê±° (í”„ë¦¬ë¯¸ì—„)
            </button>

            <button class="btn-full btn-gray" style="margin-top:15px;" onclick="closeSettingsModal()">ë‹«ê¸°</button>
        </div>
    </div>

    <div class="overlay" id="resultModal">
        <div class="modal">
            <span class="modal-icon" id="resIcon">ğŸ‰</span>
            <div class="modal-title" id="resTitle">ì„±ê³µ!</div>
            <div class="modal-desc" id="resDesc">ëª©í‘œ ì ìˆ˜ë¥¼ ë‹¬ì„±í–ˆìŠµë‹ˆë‹¤!</div>
            <button class="btn-full bg-green" id="resBtn" onclick="startWithCountdown()">ìƒˆ ê²Œì„ ì‹œì‘</button>
        </div>
    </div>

    <div class="sheet-wrapper" id="sheetOverlay" onclick="closeSheet()">
        <div class="sheet-bg"></div>
        <div class="sheet" onclick="event.stopPropagation()">
            <h2 id="sheetWord">ë‹¨ì–´</h2>
            <div id="sheetEng" class="sheet-eng-word"></div>
            <div id="sheetEngDesc" class="sheet-eng-desc"></div>
            <div id="sheetDesc" class="sheet-kor-desc"></div>
            <a href="#" id="btnNaver" class="btn-full bg-green" target="_blank" style="display:block; text-decoration:none; line-height:24px;">
                ğŸ“– ë„¤ì´ë²„ ì‚¬ì „ ê²€ìƒ‰
            </a>
            <button class="btn-full btn-gray" onclick="closeSheet()">ë‹«ê¸°</button>
        </div>
    </div>

    <script src="js/ads.js"></script> 
    <script type="module" src="js/game.js"></script>
    
</body>
</html>